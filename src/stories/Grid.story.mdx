import { Meta, Story, Preview, Props } from '@storybook/addon-docs/blocks';
import { Grid, GridItem } from '../index';
import { ThemeProvider } from '@emotion/react';
import { Item, Warning } from './story-blocks';
import { excludedProps } from './prop-values.ts';

<Meta title="Components/Grid" component={Grid} />

# Grid

The Grid is a flexible grid layout, built using CSS Grid but with fallback to Flexbox. It consists
of the `<Grid>` with a collection of `<GridItem>` elements. You set the size of each `<GridItem>`,
by defining a fraction `size` value.

<Preview>
  <Story name="Basic grid">
    <Grid gridGap="24px">
      <GridItem size={1}>
        <Item>col=12</Item>
      </GridItem>
      <GridItem size={1 / 2}>
        <Item>col=6</Item>
      </GridItem>
      <GridItem size={1 / 2}>
        <Item>col=6</Item>
      </GridItem>
      <GridItem size={1 / 4}>
        <Item>col=3</Item>
      </GridItem>
      <GridItem size={1 / 4}>
        <Item>col=3</Item>
      </GridItem>
      <GridItem size={1 / 4}>
        <Item>col=3</Item>
      </GridItem>
      <GridItem size={1 / 4}>
        <Item>col=3</Item>
      </GridItem>
      <GridItem size={1 / 12}>
        <Item>col=1</Item>
      </GridItem>
      <GridItem size={1 / 12}>
        <Item>col=1</Item>
      </GridItem>
      <GridItem size={1 / 12}>
        <Item>col=1</Item>
      </GridItem>
      <GridItem size={1 / 12}>
        <Item>col=1</Item>
      </GridItem>
      <GridItem size={1 / 12}>
        <Item>col=1</Item>
      </GridItem>
      <GridItem size={1 / 12}>
        <Item>col=1</Item>
      </GridItem>
      <GridItem size={1 / 12}>
        <Item>col=1</Item>
      </GridItem>
      <GridItem size={1 / 12}>
        <Item>col=1</Item>
      </GridItem>
      <GridItem size={1 / 12}>
        <Item>col=1</Item>
      </GridItem>
      <GridItem size={1 / 12}>
        <Item>col=1</Item>
      </GridItem>
      <GridItem size={1 / 12}>
        <Item>col=1</Item>
      </GridItem>
      <GridItem size={1 / 12}>
        <Item>col=1</Item>
      </GridItem>
    </Grid>
  </Story>
</Preview>

### Grid with default gridGap

<Preview>
  <Story name="Theme grid">
    <ThemeProvider theme={{ layout: { grid: { gridGap: 24 } } }}>
      <Grid>
        <GridItem size={1}>
          <Item>col=12</Item>
        </GridItem>
        <GridItem size={1 / 2}>
          <Item>col=6</Item>
        </GridItem>
        <GridItem size={1 / 2}>
          <Item>col=6</Item>
        </GridItem>
        <GridItem size={1 / 4}>
          <Item>col=3</Item>
        </GridItem>
        <GridItem size={1 / 4}>
          <Item>col=3</Item>
        </GridItem>
        <GridItem size={1 / 4}>
          <Item>col=3</Item>
        </GridItem>
        <GridItem size={1 / 4}>
          <Item>col=3</Item>
        </GridItem>
      </Grid>
    </ThemeProvider>
  </Story>
</Preview>

### Responsive grid

Since the `<Grid>` is built using [styled-system](), the `gridGap` and `size` values accept a
responsive value - Like the breakpoints array.

<Preview>
  <Story name="Responsive grid">
    <Grid gridGap={[16, 32]}>
      <GridItem size={[1, 4 / 8, 8 / 12]}>
        <Item>xs=12, md=6, lg=8</Item>
      </GridItem>
      <GridItem size={[1 / 2, 2 / 8, 2 / 12]}>
        <Item>xs=6, md=2, lg=2</Item>
      </GridItem>
      <GridItem size={[1 / 2, 2 / 8, 2 / 12]}>
        <Item>xs=6, md=2, lg=2</Item>
      </GridItem>
    </Grid>
  </Story>
</Preview>

### Spacer item

If you need to offset the columns, you should render an empty `<GridItem />` - e.g. a
[spacer gif](https://en.wikipedia.org/wiki/Spacer_GIF). Set the `size` it should offset the next
items. If you set the `size` to `0`, it will cause the `<GridItem>` to render with `display: none;`,
effectively removing the item from the layout. Keep in mind that setting `null` is different, in
that this just uses the previous value for the current breakpoint.

<Preview>
  <Story name="Spacer item">
    <Grid gridGap="24px">
      <GridItem size={0} />
      <GridItem size={3 / 12}>
        <Item>Item</Item>
      </GridItem>
      <GridItem size={1 / 12} style={{ background: 'antiquewhite' }} />
      <GridItem size={3 / 12}>
        <Item>Item</Item>
      </GridItem>
      <GridItem size={[1 / 12, null, 1 / 12]} style={{ background: 'antiquewhite' }} />
      <GridItem size={3 / 12}>
        <Item>Item</Item>
      </GridItem>
    </Grid>
  </Story>
</Preview>

### Grid columns

By default the grid uses a standard `12` column layout. You can, and should, change this - for
example when nesting grids, or to have fewer columns on smaller devices.

<Preview>
  <Story name="Grid columns grid">
    <Grid forceFlexBox gridColumns={10} gridGap="24px">
      <GridItem size={10 / 10}>
        <Item>10</Item>
      </GridItem>
      <GridItem size={5 / 10}>
        <Item>5</Item>
      </GridItem>
      <GridItem size={5 / 10}>
        <Item>5</Item>
      </GridItem>
      <GridItem size={3 / 10}>
        <Item>3</Item>
      </GridItem>
      <GridItem size={2 / 10}>
        <Item>2</Item>
      </GridItem>
      <GridItem size={2 / 10}>
        <Item>2</Item>
      </GridItem>
      <GridItem size={3 / 10}>
        <Item>3</Item>
      </GridItem>
    </Grid>
  </Story>
</Preview>

#### Responsive Grid Columns

It might make sense to reduce the amount of columns on smaller devices. This ensures the `gridGap`
can stay on a sane value. Usually you won't need to use more than 4 columns on a mobile and 8
columns on a tablet device.

<Preview>
  <Story name="Responsive grid columns grid">
    <Grid gridColumns={[4, 8, 12]} gridGap="24px">
      <GridItem size={[4 / 4, 8 / 8, 12 / 12]}>
        <Item>1</Item>
      </GridItem>
      <GridItem size={[2 / 4, 4 / 8, 6 / 12]}>
        <Item>1 / 2</Item>
      </GridItem>
      <GridItem size={[2 / 4, 4 / 8, 6 / 12]}>
        <Item>1 / 2</Item>
      </GridItem>
      <GridItem size={[1 / 4, 2 / 8, 3 / 12]}>
        <Item>1 / 4</Item>
      </GridItem>
      <GridItem size={[1 / 4, 2 / 8, 3 / 12]}>
        <Item>1 / 4</Item>
      </GridItem>
      <GridItem size={[1 / 4, 2 / 8, 3 / 12]}>
        <Item>1 / 4</Item>
      </GridItem>
      <GridItem size={[1 / 4, 2 / 8, 3 / 12]}>
        <Item>1 / 4</Item>
      </GridItem>
    </Grid>
  </Story>
</Preview>

### Nested grid

When nesting Grids, it might make sense to adjust the columns to match the outer Grid. This ensures
you can keep the same `gridGap`, making it possible to keep the grid aligned with the design.

<Preview>
  <Story name="Nested grids">
    <Grid gridColumns={12} gridGap="24px">
      <GridItem size={1}>
        <strong>12 columns</strong>
        <Grid gridColumns={[8, 10, 12]} gridGap="24px">
          <GridItem size={1}>
            <Item>full</Item>
          </GridItem>
          <GridItem size={1 / 2}>
            <Item>half</Item>
          </GridItem>
          <GridItem size={1 / 2}>
            <Item>half</Item>
          </GridItem>
        </Grid>
      </GridItem>
      <GridItem size={8 / 12}>
        <strong>8 columns</strong>
        <Grid gridColumns={8} gridGap="24px">
          <GridItem size={1}>
            <Item sx={{ bg: 'blue', color: 'white' }}>full</Item>
          </GridItem>
          <GridItem size={1 / 2}>
            <Item sx={{ bg: 'blue', color: 'white' }}>half</Item>
          </GridItem>
          <GridItem size={1 / 2}>
            <Item sx={{ bg: 'blue', color: 'white' }}>half</Item>
          </GridItem>
        </Grid>
      </GridItem>
      <GridItem size={4 / 12}>
        <strong>4 columns</strong>
        <Grid gridColumns={4} gridGap="24px">
          <GridItem size={1}>
            <Item sx={{ bg: 'darkred', color: 'white' }}>full</Item>
          </GridItem>
          <GridItem size={1 / 2}>
            <Item sx={{ bg: 'darkred', color: 'white' }}>half</Item>
          </GridItem>
          <GridItem size={1 / 2}>
            <Item sx={{ bg: 'darkred', color: 'white' }}>half</Item>
          </GridItem>
        </Grid>
      </GridItem>
    </Grid>
  </Story>
</Preview>

### Force Flexbox Grid

The `<Grid>` is styled using CSS Grid if it's supported, but you can always disable this and force
the Flexbox fallback to be used. This is done by setting `forceFlexBox` to `true`. Use this to debug
the Flexbox layout in a modern browser, and ensure you don't break anything.

#### With Flexbox Grid

<Preview name="Forced Flexbox grid">
  <Grid gridGap="24px" forceFlexBox>
    <GridItem size={1}>
      <Item>col=12</Item>
    </GridItem>
    <GridItem size={1 / 2}>
      <Item>col=6</Item>
    </GridItem>
    <GridItem size={1 / 2}>
      <Item>col=6</Item>
    </GridItem>
    <GridItem size={1 / 4}>
      <Item>col=3</Item>
    </GridItem>
    <GridItem size={1 / 4}>
      <Item>col=3</Item>
    </GridItem>
    <GridItem size={1 / 4}>
      <Item>col=3</Item>
    </GridItem>
    <GridItem size={1 / 4}>
      <Item>col=3</Item>
    </GridItem>
  </Grid>
</Preview>

#### With CSS Grid

<Preview name="Forced CSS grid">
  <Grid gridGap="24px" forceFlexBox={false}>
    <GridItem size={1}>
      <Item>col=12</Item>
    </GridItem>
    <GridItem size={1 / 2}>
      <Item>col=6</Item>
    </GridItem>
    <GridItem size={1 / 2}>
      <Item>col=6</Item>
    </GridItem>
    <GridItem size={1 / 4}>
      <Item>col=3</Item>
    </GridItem>
    <GridItem size={1 / 4}>
      <Item>col=3</Item>
    </GridItem>
    <GridItem size={1 / 4}>
      <Item>col=3</Item>
    </GridItem>
    <GridItem size={1 / 4}>
      <Item>col=3</Item>
    </GridItem>
  </Grid>
</Preview>

## API

The components inherit the [Box](/?path=/docs/components-box--page#props) props. Below are just the
unique props.

> To provide the Flexbox fallback the `<Grid>` uses a negative `margin`, while the `<GridItem>` uses
> `padding`. Therefore it's important that you don't change these values, since it will break the
> layout in browsers without support for CSS Grid. If you have to change the padding/margin, add it
> to the wrapping element (like `<Container>`) or the inner items.

### Grid

<Props of={Grid} exclude={excludedProps} />

#### Variants

The `<Grid>` has the default `variant` value `layout.grid` - you can use it to modify the default
styling. This can be useful to set `gridColumns` and `gridGap` globally so they match the design
style guide.

```typescript
const theme = {
  layout: {
    grid: {
      gridColumns: [4, 8, 12],
      gridGap: ['1rem', '1.5rem', '2rem'],
    },
  },
};
```

If needed, you can define different types of grid variants in this object - It's recommended to use
`enum` values to keep it typed.

```typescript
export enum GridVariant {
  Default = 'grid',
  Layout = 'layout',
}

const theme = {
  layout: {
    [GridVariant.Default]: {
      gridGap: 0,
    },
    [GridVariant.Layout]: {
      gridColumns: [4, 8, 12],
      gridGap: ['1rem', '1.5rem', '2rem'],
    },
  },
};
```

### GridItem

<Props of={GridItem} exclude={['gridColumns', ...excludedProps.filter((val) => val !== 'size')]} />

#### Variants

The `<GridItem>` has the default `variant` value `layout.gridItem` - you can use it to modify the
default styling.
